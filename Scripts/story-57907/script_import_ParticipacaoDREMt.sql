use ProvaSP_Resultado2021

CREATE TABLE [dbo].[ParticipacaoDREMt](
	[Edicao] [varchar](10) NOT NULL,
	[AreaConhecimentoID] [tinyint] NOT NULL,
	[uad_sigla] [varchar](4) NOT NULL,
	[AnoEscolar] [varchar](3) NOT NULL,
	[TotalPrevisto] [int] NOT NULL,
	[TotalPresente] [int] NOT NULL,
	[PercentualParticipacao] [decimal](6, 2) NOT NULL
)

insert into ParticipacaoDREMt values
('2021',3,'BT','3',2421,1908,78.81),
('2021',3,'CL','3',5496,4276,77.8 ),
('2021',3,'CS','3',2991,2364,79.04),
('2021',3,'FO','3',2850,2159,75.75),
('2021',3,'G' ,'3',3093,2322,75.07),
('2021',3,'IP','3',2208,1650,74.73),
('2021',3,'IQ','3',1890,1419,75.08),
('2021',3,'JT','3',2618,1939,74.06),
('2021',3,'MP','3',3894,3156,81.05),
('2021',3,'PE','3',2471,1972,79.81),
('2021',3,'PJ','3',4808,3394,70.59),
('2021',3,'SA','3',2986,2148,71.94),
('2021',3,'SM','3',4150,3205,77.23),
('2021',3,'BT','4',2692,2184,81.13),
('2021',3,'CL','4',5912,4723,79.89),
('2021',3,'CS','4',3381,2741,81.07),
('2021',3,'FO','4',2891,2268,78.45),
('2021',3,'G' ,'4',2865,2279,79.55),
('2021',3,'IP','4',2516,1927,76.59),
('2021',3,'IQ','4',1829,1494,81.68),
('2021',3,'JT','4',2462,1992,80.91),
('2021',3,'MP','4',3994,3400,85.13),
('2021',3,'PE','4',2677,2249,84.01),
('2021',3,'PJ','4',4705,3540,75.24),
('2021',3,'SA','4',2706,2129,78.68),
('2021',3,'SM','4',4046,3405,84.16),
('2021',3,'BT','5',2397,2015,84.06),
('2021',3,'CL','5',6775,5525,81.55),
('2021',3,'CS','5',3738,3100,82.93),
('2021',3,'FO','5',3422,2743,80.16),
('2021',3,'G' ,'5',3493,2867,82.08),
('2021',3,'IP','5',2483,1997,80.43),
('2021',3,'IQ','5',2737,2281,83.34),
('2021',3,'JT','5',3092,2569,83.09),
('2021',3,'MP','5',4942,4166,84.3 ),
('2021',3,'PE','5',2919,2505,85.82),
('2021',3,'PJ','5',4843,3693,76.25),
('2021',3,'SA','5',2797,2293,81.98),
('2021',3,'SM','5',4505,3700,82.13),
('2021',3,'BT','6',2529,1700,67.22),
('2021',3,'CL','6',6723,4802,71.43),
('2021',3,'CS','6',3263,2364,72.45),
('2021',3,'FO','6',3556,2393,67.29),
('2021',3,'G' ,'6',3538,2534,71.62),
('2021',3,'IP','6',3001,2064,68.78),
('2021',3,'IQ','6',2761,1909,69.14),
('2021',3,'JT','6',3333,2580,77.41),
('2021',3,'MP','6',5001,3547,70.93),
('2021',3,'PE','6',2903,2166,74.61),
('2021',3,'PJ','6',5243,3426,65.34),
('2021',3,'SA','6',3266,2248,68.83),
('2021',3,'SM','6',4689,3381,72.1 ),
('2021',3,'BT','7',2642,1753,66.35),
('2021',3,'CL','7',6928,4718,68.1 ),
('2021',3,'CS','7',3346,2414,72.15),
('2021',3,'FO','7',3483,2259,64.86),
('2021',3,'G' ,'7',3618,2452,67.77),
('2021',3,'IP','7',2935,1865,63.54),
('2021',3,'IQ','7',2874,1908,66.39),
('2021',3,'JT','7',3437,2554,74.31),
('2021',3,'MP','7',5281,3741,70.84),
('2021',3,'PE','7',3132,2244,71.65),
('2021',3,'PJ','7',5420,3491,64.41),
('2021',3,'SA','7',3121,2158,69.14),
('2021',3,'SM','7',4706,3334,70.85),
('2021',3,'BT','8',2504,1784,71.25),
('2021',3,'CL','8',6362,4486,70.51),
('2021',3,'CS','8',3082,2254,73.13),
('2021',3,'FO','8',3480,2325,66.81),
('2021',3,'G' ,'8',3460,2487,71.88),
('2021',3,'IP','8',2851,1949,68.36),
('2021',3,'IQ','8',2792,1935,69.31),
('2021',3,'JT','8',3470,2601,74.96),
('2021',3,'MP','8',4908,3525,71.82),
('2021',3,'PE','8',3057,2218,72.55),
('2021',3,'PJ','8',5291,3169,59.89),
('2021',3,'SA','8',3320,2189,65.93),
('2021',3,'SM','8',4576,3173,69.34),
('2021',3,'BT','9',2451,1669,68.09),
('2021',3,'CL','9',6119,3883,63.46),
('2021',3,'CS','9',2887,1771,61.34),
('2021',3,'FO','9',3368,1973,58.58),
('2021',3,'G' ,'9',3401,2106,61.92),
('2021',3,'IP','9',2782,1709,61.43),
('2021',3,'IQ','9',2834,1690,59.63),
('2021',3,'JT','9',3271,2109,64.48),
('2021',3,'MP','9',4804,2936,61.12),
('2021',3,'PE','9',3111,1977,63.55),
('2021',3,'PJ','9',5345,2663,49.82),
('2021',3,'SA','9',2948,1673,56.75),
('2021',3,'SM','9',4344,2709,62.36),
('2021',3,'BT','2',2757,1855,67.28),
('2021',3,'CL','2',6666,4368,65.53),
('2021',3,'CS','2',3552,2492,70.16),
('2021',3,'FO','2',3261,2132,65.38),
('2021',3,'G' ,'2',4037,2348,58.16),
('2021',3,'IP','2',2794,1701,60.88),
('2021',3,'IQ','2',2347,1588,67.66),
('2021',3,'JT','2',3391,2082,61.4 ),
('2021',3,'MP','2',4547,3254,71.56),
('2021',3,'PE','2',2790,1934,69.32),
('2021',3,'PJ','2',5805,3099,53.39),
('2021',3,'SA','2',3338,2068,61.95),
('2021',3,'SM','2',4668,3071,65.79)

UPDATE ParticipacaoDREMt SET PercentualParticipacao = ROUND(PercentualParticipacao, 1)

insert into ProvaSP.dbo.ParticipacaoDREAreaConhecimento
(Edicao,AreaConhecimentoID,uad_sigla,AnoEscolar,TotalPrevisto,
TotalPresente,PercentualParticipacao)
select Edicao, AreaConhecimentoID,uad_sigla,AnoEscolar,
TotalPrevisto,TotalPresente,PercentualParticipacao
from ParticipacaoDREMt where AnoEscolar not in ('2','3')
